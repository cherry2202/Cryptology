## 1 **平方剩余与Legendre符号**
### 1.1 平方剩余
设n为正整数，a为整数，满足$gcd(a,n)=1$，若方程$x^2\equiv a \bmod n$有解，则称a为模n的二次剩余，否则为二次非剩余。  
### 1.2 Legendre符号
设p是素数，a是一整数，符号$(\frac{a}{p})$的定义如下：  
$$ (\frac{a}{p}) = 
\begin{cases}
0， 如果a被p整除\\
1， 如果a是模p的平方剩余\\
-1， 如果a是模p的非平方剩余
\end{cases}
$$
称符号$(\frac{a}{p})$为Legendre符号。  
**计算公式**：$(\frac{a}{p})=a^{(p-1)/2} \bmod p$  
**性质**：设p为奇素数，a和b均不可被p整除，则  
1. 若$a\equiv b \bmod p$，则$(\frac{a}{p}) = (\frac{b}{p})$  
2. $(\frac{ab}{p})=(\frac{a}{p})(\frac{b}{p})$  
3. $(\frac{a^2}{p})=1$
4. $(\frac{a+p}{p})=(\frac{a}{p})$

## 2 欧几里得算法与扩展欧几里得算法
欧几里得算法基于以下结论：  
> 设a、b是任意的两个正整数，将他们的最大公因子$gcd(a,b)$记作$(a,b)$，则有以下结论$$(a,b)=(b, a\bmod b)$$

**贝祖等式**  
任意两个整数a、b，一定存在整数x、y 使得下面等式成立：$$xa+yb = gcd(a,b)$$  

### 2.1 **欧几里得算法（辗转相除法）**  
**作用**：求最大公因数  
**过程**\
设a、b为任意两个正整数，记$r_0=a,r_1=b$，反复应用上述结论，有：  
$$
r_2=r_0-r_1q_1\\
r_3=r_1-r_2q_2\\
\dots\\
r_n=r_{n-2}-r_{n-1}q_{n-1}\\
r_{n+1}=r_{n-1}-r_nq_n
$$
直到$r_{n+1}=0$停止，此时，$r_n$即为a、b的最大公因数。  
此时，若将上方的式子逐层代入，即可得到关于a、b和其最大公因数$r_n$的表达式。  

### 2.2 **扩展欧几里得算法**  
**乘法逆元**  
如果a、b互素（$gcd(a,b)=1$），则b在模a下有乘法逆元，即存在x满足$xb\equiv 1\bmod a$，该式等价于存在x满足$xb-na=1$  
**分数模**  
求$\frac{a}{b}\bmod n$等价于求x满足关系式$xb\equiv a\bmod n$。  
可见，乘法逆元为分数模的特殊情况，即a等于1时。下面以求乘法逆元为例，说明扩展欧几里得算法的过程。

故，求b的乘法逆元即可通过欧几里得算法，求出最大公因数为1时，关于a、b的表达式。  
**作用**：求乘法逆元、求分数模  
**过程**  
先利用欧几里得算法，判断最大公因子是否为1，若非1，则无逆元；若为1，则从上至下层层代入，得到关于a、b的表达式，b的系数即为b的模a下的乘法逆元。  
**例子**  
a为5，b为8，求a在模b下的乘法逆元。  
![alt text](Capture_20240629_124311.jpg)  

**用表格形式表示**  
- **初始化：**  
$(X_1, X_2, X_3)=(1, 0, a)$   
$(Y_1, Y_2, Y_3)=(0, 1, b)$  
- **计算过程：**  
$(X_1', X_2', X_3')=(Y_1, Y_2, Y_3)$  
$(Y_1', Y_2', Y_3')=(X_1, X_2, X_3)-Q(X_1', X_2', X_3')$  
其中，$Y_1, Y_2, Y_3$满足以下关系$Y_1a+Y_2b=Y_3$。  

故最后当$Y_3=1$时，模逆为$Y_1, Y_2$之一（具体根据模的是谁判断）  
**举例**   
![例子](image-3.png)  

<mark>对于求分数模的情况</mark>
只需要在$Y_3=a$时停止即可，其中a为分数的分子。